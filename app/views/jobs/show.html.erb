<% unless @job&.completed? %>
  <meta http-equiv="Refresh" content="5">
  <script>
      setTimeout(scrollToBottom, 1000);

      function scrollToBottom() {
          window.scrollTo(0, document.body.scrollHeight);
      }
  </script>
<% end %>
<h3>Job <code><%= @id %></code> Logs</h3>
<small>Status: <code><%= @job&.completed? ? 'Completed' : 'Processing' %></code></small>

<table class="table">
  <tr>
    <th scope="col">Status</th>
    <th scope="col">Count</th>
  </tr>
  <tr>
    <td><code>Info</code></td>
    <td><%= @logs.info.count rescue 0 %></td>
  </tr>
  <tr class="table-warning">
    <td><code>Warn</code></td>
    <td><%= @logs.warn.count rescue 0 %></td>
  </tr>
  <tr class="table-danger">
    <td><code>Error</code></td>
    <td><%= @logs.error.count rescue 0 %></td>
  </tr>
  <tr>
    <th scope="col">Total:</th>
    <th scope="col"><%= @logs.count %></th>
  </tr>
</table>

<table class="table table-striped">
  <tr>
    <th scope="col">Recorded At</th>
    <th scope="col">Severity</th>
    <th scope="col">Message</th>
  </tr>
  <% @logs.each do |log| %>
    <tr class="<%= (log.warn? && 'table-warning') || (log.error? && 'table-danger') %>">
      <td><%= log.created_at %></td>
      <td><code><%= log.severity.upcase %></code></td>
      <td><%= log.message %></td>
    </tr>
  <% end %>
</table>
<a href="/" class="btn">Go Back Home</a>
<a href="/jobs" class="btn">View All Jobs</a>
